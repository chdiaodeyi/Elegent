library("rstudioapi")
input.path <- dirname(getActiveDocumentContext()$path)
input.path <- gsub("/tools", "/InputData", inputPath)
xlsx.files <- fs::dir_ls(path = input.path, regexp = ".xlsx", recurse = TRUE)
input.path <- dirname(getActiveDocumentContext()$path)
input.path <- gsub("/tools", "/InputData", input.path)
xlsx.files <- fs::dir_ls(path = input.path, regexp = ".xlsx", recurse = TRUE)
library("rstudioapi")
input.path <- dirname(getActiveDocumentContext()$path)
input.path <- gsub("/tools", "/InputData", input.path)
dir.files <- fs::dir_ls(path = input.path, recurse = TRUE, type = "file")
dir.xlsx <- fs::dir_ls(path = input.path, recurse = TRUE, regexp = ".xlsx")
dir.csv <- fs::dir_ls(path = input.path, recurse = TRUE, regexp = ".csv")
dir.folder <- fs::dir_ls(path = input.path, recurse = TRUE, type = "directory")
df.folder <- data.frame(dir.folder)
View(df.folder)
df.folder <- data.frame(dir.folder)
df.folder[,2:5] <- ""
for (i in 1 : length(dir.folder)){
folder.files <-  fs::dir_ls(path = dir.folder[i], recurse = FALSE, type = "file")
folder.csv <-  fs::dir_ls(path = dir.folder[i], recurse = FALSE, regexp = ".csv")
folder.files <- folder.files[!(folder.files %in% folder.csv)]
if(length(folder.files) >0) {
df.folder[i, 2:(1+length(folder.files))] <- folder.files
}
}
View(df.folder)
library("rstudioapi")
input.path <- dirname(getActiveDocumentContext()$path)
input.path <- gsub("/tools", "/InputData", input.path)
dir.files <- fs::dir_ls(path = input.path, recurse = TRUE, type = "file")
dir.xlsx <- fs::dir_ls(path = input.path, recurse = TRUE, regexp = ".xlsx")
dir.csv <- fs::dir_ls(path = input.path, recurse = TRUE, regexp = ".csv")
dir.folder <- fs::dir_ls(path = input.path, recurse = TRUE, type = "directory")
df.folder <- data.frame(dir.folder)
View(df.folder)
dir.xlsx
basename(dir.files)
path <- substring(dir.files, 20, nchar(dir.files) - nchar(basename(dir.files)))
path[1:10]
path <- substring(dir.files, 60, nchar(dir.files) - nchar(basename(dir.files)))
path[1:10]
path <- substring(dir.files, 75, nchar(dir.files) - nchar(basename(dir.files)))
path[1:10]
df.file <- data.frame(file.path, file.basename)
file.basename <- basename(dir.files)
file.path <- substring(dir.files, 75, nchar(dir.files) - nchar(basename(dir.files)))
df.file <- data.frame(file.path, file.basename)
View(df.file)
file.basename <- basename(dir.files)
file.path <- substring(dir.files, 76, nchar(dir.files) - nchar(basename(dir.files)-1))
View(df.file)
file.basename <- basename(dir.files)
file.path <- substring(dir.files, 76, nchar(dir.files) - nchar(basename(dir.files))-1)
df.file <- data.frame(file.path, file.basename)
dir.folder <- fs::dir_ls(path = input.path, recurse = TRUE, type = "directory")
df.folder <- data.frame(dir.folder)
View(df.file)
writexl::write_xlsx(df.folder, "filename and path.xlsx")
df.folder <- data.frame(dir.file)
df.folder <- data.frame(df.file)
writexl::write_xlsx(df.file, "filename and path.xlsx")
